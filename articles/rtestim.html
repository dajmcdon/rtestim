<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rtestim">
<title>rtestim Package Vignette • rtestim</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="rtestim Package Vignette">
<meta property="og:description" content="rtestim">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rtestim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/rtestim.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>rtestim Package Vignette</h1>
            
      
      
      <div class="d-none name"><code>rtestim.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dajmcdon.github.io/rtestim/">rtestim</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: dspline</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This package uses Poisson likelihood with trend filtering penalty (a
type of regularized nonparametric regression) to estimate the effective
reproductive number, <span class="math inline">\(R_t\)</span>. This
value roughly says “how many new infections will result from each new
infection today”. Values larger than 1 indicate that an epidemic is
growing while those less than 1 indicate decline.</p>
<p>This vignette provides a few examples to demonstrate the usage of
<a href="https://dajmcdon.github.io/rtestim/">rtestim</a> to estimate the effective reproduction number,
<span class="math inline">\(R_t\)</span>. <a href="https://dajmcdon.github.io/rtestim/">rtestim</a> finds a
sequence of <span class="math inline">\(R_t\)</span>, <span class="math inline">\(\mathop{\{R_t\}_{t=1}^n}\)</span> of an infectious
disease by solving the following penalized Poisson regression <span class="math display">\[\begin{equation} \label{eq:objective_fn}
    \hat{\theta} = \mathop{\mathrm{argmin}}_{\theta} \frac{1}{n}
\sum_{t=1}^n \left(e^{\theta_{t}}x_t - y_t\theta_{t}\right) + \lambda
\Vert D^{(k+1)} \theta \Vert_1
\end{equation}\]</span> where <span class="math inline">\(y_t\)</span>
is the an epidemic signal, ideally, incident infections, but most
frequently, incident cases, on day <span class="math inline">\(t\)</span>, <span class="math inline">\(\theta_{t}
= \log(R_t)\)</span> is the natural logarithm of <span class="math inline">\(R_t\)</span> at time <span class="math inline">\(t\)</span>, <span class="math inline">\(D^{(k)}\)</span> is the <span class="math inline">\(k\)</span>-th order divided difference operator
(<span class="math inline">\(k \geq 0\)</span>). The penalty <span class="math inline">\(\Vert D^{(k+1)} \theta \Vert_1\)</span> imposes
smoothness on the solution and <span class="math inline">\(\lambda\)</span> controls the level of this
smoothness, with larger <span class="math inline">\(\lambda\)</span>
resulting in smoother estimates.</p>
<p>In particular <span class="math display">\[\begin{equation}
x_t = \sum_{a = 1}^m y_{t-a} w_a
\end{equation}\]</span> is the weighted sum of previous incidence at
<span class="math inline">\(t\)</span>, calculated by convolving the
preceding <span class="math inline">\(m\)</span> days of new infections
with the discretized serial interval distribution <span class="math inline">\(w\)</span> of length <span class="math inline">\(m\)</span>. This delay distribution encapsulates
the duration of time that a previous infection is likely to lead to
future infection.</p>
<p>To compute <span class="math inline">\(\mathop{\{R_t\}_{t=1}^n}\)</span> with
<a href="https://dajmcdon.github.io/rtestim/">rtestim</a>, the minimal information needed is the new case
counts at days up until <span class="math inline">\(t\)</span> and a
parametric form for the serial interval distribution (a Gamma density).
By default, <span class="math inline">\(2.5\)</span> is used for both
the scale and shape parameters, based on the literature on contract
tracing, representing the typical delay between case onsets. This is
discretized to be supported on the integers. The order of the difference
operator, the degree of smoothness, defaults to <span class="math inline">\(3\)</span>. The sequence of smoothness penalty
<span class="math inline">\(\lambda\)</span>, if no <span class="math inline">\(\lambda\)</span> is provided, is calculated
internally by the algorithm.</p>
</div>
<div class="section level2">
<h2 id="example---synthetic-dataset">Example - synthetic dataset<a class="anchor" aria-label="anchor" href="#example---synthetic-dataset"></a>
</h2>
<div class="section level3">
<h3 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h3>
<p>We first demonstrate the usage of the package on synthetic data,
where the new daily case counts are generated from a Poisson
distribution with mean parameter that roughly follows a wave. Note that
the first observation must be strictly larger than 0.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">case_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">50</span>, <span class="fl">15</span><span class="op">)</span> <span class="op">*</span> <span class="fl">500</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">101</span>, <span class="va">case_counts</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">case_counts</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"cornflowerblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Time"</span>, y <span class="op">=</span> <span class="st">"Case Counts"</span><span class="op">)</span></span></code></pre></div>
<p><img src="rtestim_files/figure-html/unnamed-chunk-2-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Next, we fit the model and visualize the resulting <span class="math inline">\(\mathop{\{R_t\}_{t=1}^n}\)</span>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_rt.html">estimate_rt</a></span><span class="op">(</span>observed_counts <span class="op">=</span> <span class="va">case_counts</span>, nsol <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="rtestim_files/figure-html/unnamed-chunk-3-1.png" width="100%" style="display: block; margin: auto;"></p>
<p><a href="https://dajmcdon.github.io/rtestim/">rtestim</a> estimates a spectrum of <span class="math inline">\(\mathop{\{R_t\}_{t=1}^n}\)</span>s for a range of
<span class="math inline">\(\lambda\)</span> values, where each <span class="math inline">\(\mathop{\{R_t\}_{t=1}^n}\)</span> corresponds to a
specific <span class="math inline">\(\lambda\)</span> value. If no <span class="math inline">\(\lambda\)</span> value is supplied by the user,
<a href="https://dajmcdon.github.io/rtestim/">rtestim</a> will automatically calculate a sequence of <span class="math inline">\(\lambda\)</span> values. The additional parameter
<code>nsol = 20</code> specifies the number of <span class="math inline">\(\lambda\)</span>s for which the <span class="math inline">\(\mathop{\{R_t\}_{t=1}^n}\)</span> is
calculated</p>
</div>
<div class="section level3">
<h3 id="cross-validation">Cross Validation<a class="anchor" aria-label="anchor" href="#cross-validation"></a>
</h3>
<p><a href="https://dajmcdon.github.io/rtestim/">rtestim</a> also provides a cross validation procedure for
selecting the amount of smoothness to be used in the final estimate
(leave-every-k-th-out cross validation). Minimizing this metric, in
principle, balances prediction error and smoothness
(<code>lambda.min</code>) though if smoother estimates are desired, one
can instead use <code>lambda.1se</code>, the largest value of <span class="math inline">\(\lambda\)</span> within one standard error of the
minimum.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv_estimate_rt.html">cv_estimate_rt</a></span><span class="op">(</span>observed_counts <span class="op">=</span> <span class="va">case_counts</span><span class="op">)</span></span></code></pre></div>
<p>The following command plots the cross validation errors for each
<span class="math inline">\(\lambda\)</span> in ascending order.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_cv</span><span class="op">)</span></span></code></pre></div>
<p><img src="rtestim_files/figure-html/unnamed-chunk-5-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The plot above displays vertical lines that correspond to the
cross-validation scores for specific values of <span class="math inline">\(\lambda\)</span>. The blue point at the center of
each line represents the mean score for that value of <span class="math inline">\(\lambda\)</span> across all cross-validation
folds. The top and bottom caps of each line indicate one
cross-validation standard error above and below the mean score for the
given value of <span class="math inline">\(\lambda\)</span> across all
cross-validation folds. Two special values of <span class="math inline">\(\lambda\)</span>’s are highlighted with dashed
lines. The one on the left represents the <span class="math inline">\(\lambda\)</span> that gives minimum mean
cross-validated error, called <code>lambda.min</code>, and the one on
the right gives the most regularized model such that the cross-validated
error is within one standard error of the minimum, called
<code>lambda.1se</code>.</p>
<p>Users may wish to visualize the particular <span class="math inline">\(\mathop{\{R_t\}_{t=1}^n}\)</span> which minimizes
the cross-validation error while prioritizing smoothness.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod_cv</span>, which_lambda <span class="op">=</span> <span class="st">'lambda.1se'</span><span class="op">)</span></span></code></pre></div>
<p><img src="rtestim_files/figure-html/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="uneven-reporting-frequency">Uneven Reporting Frequency<a class="anchor" aria-label="anchor" href="#uneven-reporting-frequency"></a>
</h3>
<p>Ideally, case counts are observed at regular intervals, such as daily
or weekly, but this is not always the case. <a href="https://dajmcdon.github.io/rtestim/">rtestim</a> also
accommodates scenarios in which cases are reported with uneven
intervals. To demonstrate this, we generate a sequence of integers
representing the days at which we observe the case counts.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">observation_incr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">101</span>, lambda <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">observation_incr</span><span class="op">[</span><span class="va">observation_incr</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="va">observation_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">observation_incr</span><span class="op">)</span></span></code></pre></div>
<p>We can then fit the model by passing the observation time point as
<code>x</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_rt.html">estimate_rt</a></span><span class="op">(</span>observed_counts <span class="op">=</span> <span class="va">case_counts</span>, x <span class="op">=</span> <span class="va">observation_time</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<p><img src="rtestim_files/figure-html/unnamed-chunk-8-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="changing-degree-of-difference-operator">Changing degree of difference operator<a class="anchor" aria-label="anchor" href="#changing-degree-of-difference-operator"></a>
</h3>
<p>The degree of the estimated penalized Poisson regression function
<span class="math inline">\(k\)</span> defaults to 3 for the algorithm,
which corresponds to a piece-wise cubic estimate <span class="math inline">\(\mathop{\{R_t\}_{t=1}^n}\)</span>. To estimate
<span class="math inline">\(\mathop{\{R_t\}_{t=1}^n}\)</span> with
piece-wise constant curves for example, use the command</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_rt.html">estimate_rt</a></span><span class="op">(</span>observed_counts <span class="op">=</span> <span class="va">case_counts</span>, korder <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></code></pre></div>
<p><img src="rtestim_files/figure-html/unnamed-chunk-9-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="example---canadian-covid-19-cases">Example - Canadian Covid-19 cases<a class="anchor" aria-label="anchor" href="#example---canadian-covid-19-cases"></a>
</h2>
<p>Finally, we use a long history of real case counts in Canada. The
data is available from <a href="https://opencovid.ca" class="external-link">opencovid.ca</a>
and the version downloaded on 4 July 2023 is included in the package. We
use this data to estimate <span class="math inline">\(R_t\)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">can</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_rt.html">estimate_rt</a></span><span class="op">(</span><span class="va">cancovid</span><span class="op">$</span><span class="va">incident_cases</span>, nsol <span class="op">=</span> <span class="fl">20</span>, maxiter <span class="op">=</span> <span class="fl">1e6</span><span class="op">)</span></span>
<span><span class="va">labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2023-01-01"</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"12 months"</span><span class="op">)</span></span>
<span><span class="va">breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">cancovid</span><span class="op">$</span><span class="va">date</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">labs</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">can</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="va">breaks</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strptime.html" class="external-link">strftime</a></span><span class="op">(</span><span class="va">labs</span>, <span class="st">"%Y"</span><span class="op">)</span>, </span>
<span>                     name <span class="op">=</span> <span class="st">"Year"</span><span class="op">)</span></span></code></pre></div>
<p><img src="rtestim_files/figure-html/unnamed-chunk-10-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Daniel J. McDonald, Zhenglun Cai, Jiaping Liu.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
