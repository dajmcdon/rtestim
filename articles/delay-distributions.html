<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Delay distributions • rtestim</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Delay distributions">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rtestim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/rtestim.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/delay-distributions.html">Delay distributions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dajmcdon/rtestim/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Delay distributions</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dajmcdon/rtestim/blob/main/vignettes/delay-distributions.Rmd" class="external-link"><code>vignettes/delay-distributions.Rmd</code></a></small>
      <div class="d-none name"><code>delay-distributions.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dajmcdon/rtestim" class="external-link">rtestim</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">nnet</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/" class="external-link">forcats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://Matrix.R-forge.R-project.org" class="external-link">Matrix</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/get_theme.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This package accommodates 3 different ways of specifying a delay
distribution in the renewal equation, and this vignette illustrates
these in turn. The renewal equation specifies that the expected
incidence at time <span class="math inline">\(t\)</span> is a weighted
sum of previous incidence, multiplied by <span class="math inline">\(R_t\)</span>: <span class="math display">\[\begin{equation}
\mathbb{E}[I_t \mid I_1,\ldots,I_{t-1}] = R_t \sum_{a=0}^t w_a I_{t-a},
\end{equation}\]</span> calculated by convolving the preceding <span class="math inline">\(a\)</span> days of new infections with the
discretized generation (or serial) interval distribution <span class="math inline">\(w\)</span> of length <span class="math inline">\(t\)</span>. It is the allowable distributions
<span class="math inline">\(\{w\}_{a=0}^n\)</span> that are the
focus.</p>
<div class="section level2">
<h2 id="discretization">Discretization<a class="anchor" aria-label="anchor" href="#discretization"></a>
</h2>
<p>First, it is important to recognize that the sequence <span class="math inline">\(\{w\}_{a=0}^n\)</span> is usually a discretization
of a probability density function, most frequently gamma or Weibull.
This is because observed incidence happens at discrete time points like
days or weeks, while time is continuous. Using the default (parametric)
delay distributions requires calculating a discrete approximation.</p>
</div>
<div class="section level2">
<h2 id="default-parametric-delay-distribution">Default (parametric) delay distribution<a class="anchor" aria-label="anchor" href="#default-parametric-delay-distribution"></a>
</h2>
<p>By default, <code><a href="../reference/estimate_rt.html">estimate_rt()</a></code> uses a gamma distribution
parameterized by the shape <span class="math inline">\(k\)</span> and
scale <span class="math inline">\(\theta\)</span>. This density has pdf
<span class="math display">\[
f_W(w) = \frac{1}{\Gamma(k)\theta^k} w^{k-1} e^{-w/\theta} I(w &gt; 0),
\]</span> where <span class="math inline">\(I\)</span> is the indicator
function. The mean of this distribution is <span class="math inline">\(k\theta\)</span>, and the variance is <span class="math inline">\(k\theta^2\)</span>. Both <span class="math inline">\(k\)</span> and <span class="math inline">\(\theta\)</span> must be greater than 0. The figure
below shows a few examples densities from this family.</p>
<p><img src="delay-distributions_files/figure-html/gamma-pdf-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>The default is the orange curve shown above. Given an incidence
sequence of length <span class="math inline">\(n\)</span>, internally,
<code><a href="../reference/delay_calculator.html">delay_calculator()</a></code> creates <span class="math inline">\(\{w\}_{a=0}^n\)</span> by <span class="math display">\[
w_a = F(a + 1) - F(a - 1),
\]</span> and then renormalizing with <code>w / sum(w)</code> to ensure
that it sums to 1. Here, <span class="math inline">\(F\)</span> is the
cumulative distribution function for Gamma (though similar works for any
continuous distribution). Note that this formula assumes that the
probability of a 0 delay is <em>not</em> 0. This is related to the
phenomenon of “double interval censoring”: a primary infection on day
<span class="math inline">\(t\)</span> may have occurred any time
between 0:00 and 23:59 and the same for a secondary infection on day
<span class="math inline">\(t+1\)</span>. So even if the gap in reported
days is only “1 day”, those infections may have happened as little as a
few minutes apart, or as much as 48 hours apart.</p>
<p>When using this default, the delay distribution is necessarily
assumed to be the same for all <span class="math inline">\(t\)</span>,
and we compute the convolution of <code>w</code> and <code>I</code> with
the Fast Fourier Transform.</p>
<p>Just to illustrate this behaviour, we show the results for the
default setting on the included <code>cancovid</code> data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">can_default</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_rt.html">estimate_rt</a></span><span class="op">(</span><span class="va">cancovid</span><span class="op">$</span><span class="va">incident_cases</span>, x <span class="op">=</span> <span class="va">cancovid</span><span class="op">$</span><span class="va">date</span>, nsol <span class="op">=</span> <span class="fl">20L</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">can_default</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="delay-distributions_files/figure-html/can-default-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="constant-non-parametric-delay-distribution">Constant, non-parametric delay distribution<a class="anchor" aria-label="anchor" href="#constant-non-parametric-delay-distribution"></a>
</h2>
<p>If we don’t believe that the Gamma distribution closely approximates
the serial interval distribution, then we can specify our own
distribution manually. For example, <a href="https://doi.org/10.2807/1560-7917.ES.2022.27.6.2200042" class="external-link">Backer et
al., Table S1</a> gives observed serial intervals for the Omicron (SGTF)
and Delta (non-SGTF) COVID-19 variants during 2 weeks in 2021 in the
Netherlands. For the sake of illustration, we aggregate these together
and use this as our (constant) delay distribution.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Data from Backer et al.</span></span>
<span><span class="va">delay</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"backer.csv"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">delay</span> <span class="op">&gt;=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">delay</span><span class="op">)</span></span>
<span><span class="va">delay</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums-methods.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">delay</span><span class="op">)</span></span>
<span><span class="va">delay</span> <span class="op">&lt;-</span> <span class="va">delay</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">delay</span><span class="op">)</span></span></code></pre></div>
<p><img src="delay-distributions_files/figure-html/cancov-nonpar-plot-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>This distribution looks something like a gamma, but it has finite
support. We can easily use it instead.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">can_nonpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_rt.html">estimate_rt</a></span><span class="op">(</span></span>
<span>  <span class="va">cancovid</span><span class="op">$</span><span class="va">incident_cases</span>, </span>
<span>  x <span class="op">=</span> <span class="va">cancovid</span><span class="op">$</span><span class="va">date</span>, </span>
<span>  delay_distn <span class="op">=</span> <span class="va">delay</span>,</span>
<span>  nsol <span class="op">=</span> <span class="fl">20L</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">can_nonpar</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="delay-distributions_files/figure-html/can-nonpar-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>The result is much less dramatic than the previous version. This is
likely because the distribution is much more concentrated near short
delays. We can see this by examining the two CDFs.</p>
<p><img src="delay-distributions_files/figure-html/cdfs-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="time-varying-delays">Time-varying delays<a class="anchor" aria-label="anchor" href="#time-varying-delays"></a>
</h2>
<p>Finally, we also allow time-varying delay distributions. This is
accomplished with a matrix. This requires a bit of work, but is not too
challenging. For example, to create the correct matrix using the Baker
et al. delays, the necessary code is the following.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># library(Matrix)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cancovid</span><span class="op">)</span></span>
<span><span class="va">backer_delay</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">delay</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">delay</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">delay_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span>, <span class="va">n</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">iter</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="va">delay_mat</span><span class="op">[</span><span class="va">iter</span>, <span class="fl">1</span><span class="op">:</span><span class="va">iter</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">backer_delay</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">iter</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">delay_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/drop0.html" class="external-link">drop0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">delay_mat</span>, <span class="st">"CsparseMatrix"</span><span class="op">)</span><span class="op">)</span> <span class="co"># make it sparse, not necessary</span></span>
<span><span class="va">delay_mat</span> <span class="op">&lt;-</span> <span class="va">delay_mat</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums-methods.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">delay_mat</span><span class="op">)</span> <span class="co"># renormalize</span></span></code></pre></div>
<p>We could then simply pass <code>delay_mat</code> to
<code>estimate_rt(..., delay_distn = delay_mat)</code>. The result would
be the same as that shown above.</p>
</div>
<div class="section level2">
<h2 id="variant-specific-delays">Variant-specific delays<a class="anchor" aria-label="anchor" href="#variant-specific-delays"></a>
</h2>
<p>For a more illustrative version of the previous example, we revisit
the Canadian data, but combine it with some additional information.</p>
<p>We use variant circulation information from <a href="https://covarr-net.github.io/duotang/duotang.html" class="external-link">CoVaRR-Net’s
Duotang notebook</a>. For simplicity, the code for this processing is
hidden in the fold.</p>
<details><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run on 19 April 2024</span></span>
<span><span class="va">duotang</span> <span class="op">&lt;-</span> <span class="fu">read_tsv</span><span class="op">(</span><span class="st">"https://github.com/CoVaRR-NET/duotang/raw/main/data_needed/virusseq.metadata.csv.gz"</span><span class="op">)</span></span>
<span><span class="va">columnlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"fasta_header_name"</span>, <span class="st">"province"</span>, <span class="st">"host_gender"</span>, <span class="st">"host_age_bin"</span>,</span>
<span>  <span class="st">"sample_collection_date"</span>, <span class="st">"sample_collected_by"</span>,</span>
<span>  <span class="st">"purpose_of_sampling"</span>, <span class="st">"purpose_of_sequencing"</span>, <span class="st">"lineage"</span>,</span>
<span>  <span class="st">"raw_lineage"</span>, <span class="st">"gisaid_accession"</span>, <span class="st">"isolate"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">unknown.str</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Undeclared"</span>, <span class="st">"Not Provided"</span>, <span class="st">"Restricted Access"</span>, <span class="st">"Missing"</span>,</span>
<span>  <span class="st">"Not Applicable"</span>, <span class="st">""</span>, <span class="st">"NA"</span>, <span class="st">"unknow"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">duotang</span> <span class="op">&lt;-</span> <span class="va">duotang</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>province <span class="op">=</span> <span class="va">geo_loc_name_state_province_territory</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">columnlist</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">meta</span> <span class="op">&lt;-</span> <span class="va">duotang</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    week <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">sample_collection_date</span>, <span class="st">"week"</span><span class="op">)</span>,</span>
<span>    month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"-..$"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">sample_collection_date</span>, <span class="st">"month"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">"https://github.com/CoVaRR-NET/duotang/raw/main/scripts/scanlineages.R"</span><span class="op">)</span></span>
<span><span class="va">meta</span> <span class="op">&lt;-</span> <span class="va">meta</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>gisaid_accession <span class="op">=</span> <span class="fu">str_replace</span><span class="op">(</span><span class="va">gisaid_accession</span>, <span class="st">"EPI_ISL_"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>GID <span class="op">=</span> <span class="va">gisaid_accession</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html" class="external-link">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>raw_lineage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^X"</span>, <span class="va">raw_lineage</span><span class="op">)</span>,</span>
<span>    <span class="fu">str_replace_all</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>      <span class="fu">realtorawlineage</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span></span>
<span>        <span class="va">raw_lineage</span>, <span class="fl">1</span>, <span class="fu">str_locate</span><span class="op">(</span><span class="va">raw_lineage</span>, <span class="st">"\\."</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span>      <span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="st">"."</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/substr.html" class="external-link">substr</a></span><span class="op">(</span><span class="va">raw_lineage</span>, <span class="fu">str_locate</span><span class="op">(</span><span class="va">raw_lineage</span>, <span class="st">"\\."</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">raw_lineage</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span>, <span class="st">"[\r\n]"</span>, <span class="st">""</span><span class="op">)</span>,</span>
<span>    <span class="va">raw_lineage</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">dico</span> <span class="op">&lt;-</span> <span class="fu">makepangolindico</span><span class="op">(</span><span class="op">)</span> <span class="co"># rebuild the lineage dictionary so the correct names gets assigned for XBB descedants not named XBB</span></span>
<span></span>
<span><span class="va">VOCVOI</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"https://raw.githubusercontent.com/CoVaRR-NET/duotang/main/resources/vocvoi.csv"</span><span class="op">)</span></span>
<span><span class="va">meta</span><span class="op">$</span><span class="va">pango_group</span> <span class="op">&lt;-</span> <span class="fu">create.pango.group</span><span class="op">(</span><span class="va">VOCVOI</span>, <span class="va">meta</span><span class="op">)</span></span>
<span><span class="va">meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">meta</span>, <span class="va">province</span>, <span class="va">week</span>, <span class="va">pango_group</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>week <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">week</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">meta</span>, <span class="va">province</span>, <span class="va">week</span>, <span class="va">pango_group</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">province</span>, <span class="va">week</span>, <span class="va">pango_group</span><span class="op">)</span></span>
<span><span class="va">can_counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">meta</span>, <span class="va">week</span>, <span class="va">pango_group</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">week</span>, <span class="va">pango_group</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>province <span class="op">=</span> <span class="st">"Canada"</span><span class="op">)</span></span>
<span><span class="va">counts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">can_counts</span>, <span class="va">counts</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">counts</span>, <span class="st">"duotang-counts.rds"</span><span class="op">)</span></span></code></pre></div>
</details><p>We smooth the raw data using multinomial logistic regression on a
third order orthogonal polynomial to produce the following estimated
variant proportions in Canada.</p>
<p><img src="delay-distributions_files/figure-html/duotang-counts-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>Using the estimated proportions, we label each date with the dominant
variant at the time (and restrict ourselves to the time period of the
included case data).</p>
<p><img src="delay-distributions_files/figure-html/unnamed-chunk-2-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="creating-delay-distributions">Creating delay distributions<a class="anchor" aria-label="anchor" href="#creating-delay-distributions"></a>
</h2>
<p>We use the delay distribution data from the meta analysis in <a href="https://doi.org/10.1186/s12916-023-03070-8" class="external-link">Xu, X., Wu, Y.,
Kummer, A.G. et al.</a>. The raw data for their analysis is available on
<a href="https://github.com/xxyy0574/COVID-19-transmission-parameters" class="external-link">GitHub</a>.
We use a simple version of their procedure, taking the median
calculations across studies to find the mean and standard deviation of
the delay for each variant separately. Then we convert these to the
<span class="math inline">\(k\)</span> and <span class="math inline">\(\theta\)</span> parameters for the gamma
distribution. This analysis is hidden below the fold.</p>
<details><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_raw</span> <span class="op">&lt;-</span> <span class="fu">readxl</span><span class="fu">::</span><span class="fu">read_excel</span><span class="op">(</span><span class="st">"xu-etal-DATA_RAW.xlsx"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">type</span>, <span class="va">para</span>, n <span class="op">=</span> <span class="va">Sample_size</span>, <span class="va">mean</span>, <span class="va">sd</span>, <span class="va">se</span>, <span class="va">median</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">type</span>, <span class="va">para</span><span class="op">)</span>, <span class="va">as.numeric</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">bonehead_meta</span> <span class="op">&lt;-</span> <span class="va">data_raw</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">type</span>, <span class="va">para</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    no_n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">~</span> <span class="va">n</span>, <span class="va">no_n</span> <span class="op">~</span> <span class="fl">1</span>, <span class="cn">TRUE</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">n</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span> <span class="op">~</span> <span class="va">mean</span>, <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">median</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sd</span><span class="op">)</span> <span class="op">~</span> <span class="va">sd</span>, <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">se</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">type</span>, <span class="va">para</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">sd</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">## There's only one Beta and only IP. </span></span>
<span><span class="co">## We use the corresponding sd for Alpha IP, </span></span>
<span><span class="co">## and duplicate Alpha for GT / ST</span></span>
<span></span>
<span><span class="va">Beta_IP</span> <span class="op">&lt;-</span> <span class="va">bonehead_meta</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Beta"</span><span class="op">)</span></span>
<span><span class="va">Beta_IP</span><span class="op">$</span><span class="va">sd</span> <span class="op">=</span> <span class="va">bonehead_meta</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Alpha"</span>, <span class="va">para</span> <span class="op">==</span> <span class="st">"IP"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">sd</span><span class="op">)</span></span>
<span><span class="va">Beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="va">Beta_IP</span>,</span>
<span>  <span class="va">bonehead_meta</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="st">"Alpha"</span>, <span class="va">para</span> <span class="op">!=</span> <span class="st">"IP"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"Beta"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">delay_dstns_byvar</span> <span class="op">&lt;-</span> <span class="va">bonehead_meta</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">!=</span> <span class="st">"Beta"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">Beta</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">type</span>, <span class="va">para</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="va">mean</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">sd</span><span class="op">^</span><span class="fl">2</span>, scale <span class="op">=</span> <span class="va">mean</span> <span class="op">/</span> <span class="va">shape</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">delay_dstns_byvar</span>, <span class="st">"delay-distns-byvar.rds"</span><span class="op">)</span></span></code></pre></div>
</details><p>We’ll use just the Serial Intervals (SI), though the incubation
periods (IP), and generation times (GT) are also available. Below, we
visualize the estimated delays for the 4 variants that were most
prevalent in Canada.</p>
<p><img src="delay-distributions_files/figure-html/variant-si-plot-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>We use these delays during the period they were most prevalent to
estimate Rt. First, we build the delay matrix.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">cancovid</span><span class="op">)</span></span>
<span><span class="va">delay_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span>, <span class="va">n</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">iter</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">current_var</span> <span class="op">&lt;-</span> <span class="va">can_pred_class</span><span class="op">$</span><span class="va">var</span><span class="op">[</span><span class="va">iter</span><span class="op">]</span></span>
<span>  <span class="va">current_pars</span> <span class="op">&lt;-</span> <span class="va">delay_dstns_can</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op">==</span> <span class="va">current_var</span><span class="op">)</span></span>
<span>  <span class="va">delay</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/discretize_gamma.html">discretize_gamma</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="va">iter</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>, <span class="va">current_pars</span><span class="op">$</span><span class="va">shape</span>, <span class="va">current_pars</span><span class="op">$</span><span class="va">scale</span><span class="op">)</span></span>
<span>  <span class="va">delay_mat</span><span class="op">[</span><span class="va">iter</span>, <span class="fl">1</span><span class="op">:</span><span class="va">iter</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">delay</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">delay_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/drop0.html" class="external-link">drop0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">delay_mat</span>, <span class="st">"CsparseMatrix"</span><span class="op">)</span><span class="op">)</span> <span class="co"># make it sparse, not necessary</span></span>
<span><span class="va">delay_mat</span> <span class="op">&lt;-</span> <span class="va">delay_mat</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums-methods.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">delay_mat</span><span class="op">)</span> <span class="co"># renormalize</span></span></code></pre></div>
<p>Finally, we use this time-varying delay matrix to estimate Rt.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">can_tvar</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/estimate_rt.html">estimate_rt</a></span><span class="op">(</span></span>
<span>  <span class="va">cancovid</span><span class="op">$</span><span class="va">incident_cases</span>, </span>
<span>  x <span class="op">=</span> <span class="va">cancovid</span><span class="op">$</span><span class="va">date</span>, </span>
<span>  delay_distn <span class="op">=</span> <span class="va">delay_mat</span>,</span>
<span>  nsol <span class="op">=</span> <span class="fl">20L</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">can_tvar</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="delay-distributions_files/figure-html/tvar-Rt-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel J. McDonald, Jiaping Liu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
