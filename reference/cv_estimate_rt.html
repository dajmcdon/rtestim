<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Leave-kth-out cross validation for choosing a optimal parameter lambda"><title>Leave-kth-out cross validation for choosing a optimal parameter lambda — cv_estimate_rt • rtestim</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Leave-kth-out cross validation for choosing a optimal parameter lambda — cv_estimate_rt"><meta property="og:description" content="Leave-kth-out cross validation for choosing a optimal parameter lambda"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rtestim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/rtestim.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/delay-distributions.html">Delay distributions</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dajmcdon/rtestim/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Leave-kth-out cross validation for choosing a optimal parameter lambda</h1>
      <small class="dont-index">Source: <a href="https://github.com/dajmcdon/rtestim/blob/HEAD/R/cv_estimate_rt.R" class="external-link"><code>R/cv_estimate_rt.R</code></a></small>
      <div class="d-none name"><code>cv_estimate_rt.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Leave-kth-out cross validation for choosing a optimal parameter lambda</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cv_estimate_rt</span><span class="op">(</span></span>
<span>  <span class="va">observed_counts</span>,</span>
<span>  korder <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>  dist_gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>  nfold <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>  error_measure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"deviance"</span>, <span class="st">"mse"</span>, <span class="st">"mae"</span><span class="op">)</span>,</span>
<span>  x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span>,</span>
<span>  lambda <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxiter <span class="op">=</span> <span class="fl">1000000L</span>,</span>
<span>  delay_distn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  delay_distn_periodicity <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  regular_splits <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  invert_splits <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>observed_counts</dt>
<dd><p>vector of the observed daily infection counts</p></dd>


<dt>korder</dt>
<dd><p>Integer. Degree of the piecewise polynomial curve to be
estimated. For example, <code>korder = 0</code> corresponds to a piecewise constant
curve.</p></dd>


<dt>dist_gamma</dt>
<dd><p>Vector of length 2. These are the shape and scale for the
assumed serial interval distribution. Roughly, this distribution describes
the probability of an infectious individual infecting someone else after
some period of time after having become infectious.
As in most literature, we assume that this interval follows a gamma
distribution with some shape and scale.</p></dd>


<dt>nfold</dt>
<dd><p>Integer. This number of folds to conduct the leave-kth-out
cross validation. For leave-kth-out cross validation, every kth
observed_counts and their corresponding position (evenly or unevenly
spaced) are placed into the same fold. The first and last observed_counts are
not assigned to any folds. Smallest allowable value is <code>nfold = 2</code>.</p></dd>


<dt>error_measure</dt>
<dd><p>Metric used to calculate cross validation scores.
Must be choose from <code>mse</code>, <code>mae</code>, and <code>deviance</code>.
<code>mse</code> calculates the mean square error; <code>mae</code> calculates the mean absolute error;
<code>deviance</code> calculates the deviance</p></dd>


<dt>x</dt>
<dd><p>a vector of positions at which the counts have been observed. In an
ideal case, we would observe data at regular intervals (e.g. daily or
weekly) but this may not always be the case. May be numeric or Date.</p></dd>


<dt>lambda</dt>
<dd><p>Vector. A user supplied sequence of tuning parameters which
determines the balance between data fidelity and
smoothness of the estimated Rt; larger <code>lambda</code> results in a smoother
estimate. The default, <code>NULL</code>
results in an automatic computation based on <code>nlambda</code>, the largest value
of <code>lambda</code> that would result in a maximally smooth estimate, and <code>lambda_min_ratio</code>.
Supplying a value of <code>lambda</code> overrides
this behaviour. It is likely better to supply a
decreasing sequence of <code>lambda</code> values than a single (small) value. If
supplied, the user-defined <code>lambda</code> sequence is automatically sorted in
decreasing order.</p></dd>


<dt>maxiter</dt>
<dd><p>Integer. Maximum number of iterations for the estimation
algorithm.</p></dd>


<dt>delay_distn</dt>
<dd><p>in the case of a non-gamma delay distribution,
a vector or matrix (or <code><a href="https://rdrr.io/pkg/Matrix/man/Matrix.html" class="external-link">Matrix::Matrix()</a></code>) of delay probabilities may be
passed here. For a vector, these will be coerced
to sum to 1, and padded with 0 in the right tail if necessary. If a
time-varying delay matrix, it must be lower-triangular. Each row will be
silently coerced to sum to 1. See also <code><a href="../articles/delay-distributions.html">vignette("delay-distributions")</a></code>.</p></dd>


<dt>delay_distn_periodicity</dt>
<dd><p>Controls the relationship between the spacing
of the computed delay distribution and the spacing of <code>x</code>. In the default
case, <code>x</code> would be regular on the sequence <code>1:length(observed_cases)</code>,
and this would
be 1. But if <code>x</code> is a <code>Date</code> object or spaced irregularly, the relationship
becomes more complicated. For example, weekly data when <code>x</code> is a date in
the form <code>YYYY-MM-DD</code> requires specifying <code>delay_distn_periodicity = "1 week"</code>.
Or if <code>observed_cases</code> were reported on Monday, Wednesday, and Friday,
then <code>delay_distn_periodicity = "1 day"</code> would be most appropriate.</p></dd>


<dt>regular_splits</dt>
<dd><p>Logical.
If <code>TRUE</code>, the folds for k-fold cross-validation are chosen by placing
every kth point into the same fold. The first and last points are not
included in any fold and are always included in building the predictive
model. As an example, with 15 data points and <code>kfold = 4</code>, the points are
assigned to folds in the following way:
$$
  0 \; 1 \; 2 \; 3 \; 4 \; 1 \; 2 \; 3 \;  4 \; 1 \; 2 \; 3 \; 4 \; 1 \; 0
  $$ where 0 indicates no assignment.
Therefore, the folds are not random and running <code>cv_estimate_rt()</code> twice
will give the same result.</p></dd>


<dt>invert_splits</dt>
<dd><p>Logical.
Typical K-fold CV would use K-1 folds for the training
set while reserving 1 fold for evaluation (repeating the split K times).
Setting this to true inverts this process, using a much smaller training
set with a larger evaluation set. This tends to result in larger values
of <code>lambda</code> that minimize CV.</p></dd>


<dt>...</dt>
<dd><p>additional parameters passed to <code><a href="estimate_rt.html">estimate_rt()</a></code> function</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object with S3 class <code>"cv_poisson_rt"</code>. Among the list components:</p><ul><li><p><code>full_fit</code> An object with S3 class <code>"poisson_rt"</code>, fitted with all
<code>observed_counts</code> and <code>lambda</code></p></li>
<li><p><code>cv_scores</code> leave-kth-out cross validation scores</p></li>
<li><p><code>cv_se</code> leave-kth-out cross validation standard error</p></li>
<li><p><code>lambda.min</code> lambda which achieved the optimal cross validation score</p></li>
<li><p><code>lambda.1se</code> lambda that gives the optimal cross validation score
within one standard error.</p></li>
<li><p><code>lambda</code> the value of <code>lambda</code> used in the algorithm.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">50</span>, <span class="fl">15</span><span class="op">)</span> <span class="op">*</span> <span class="fl">500</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cv</span> <span class="op">&lt;-</span> <span class="fu">cv_estimate_rt</span><span class="op">(</span><span class="va">y</span>, korder <span class="op">=</span> <span class="fl">3</span>, nfold <span class="op">=</span> <span class="fl">3</span>, nsol <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cv</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: cv_estimate_rt(observed_counts = y, korder = 3, nfold = 3, nsol = 30)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Degree of the estimated piecewise polynomial curve: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of cross validation across lambda:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 lambda index cv_scores  cv_se dof</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Max Lambda   389.76724     1     1.818 0.2137   4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> CV Minimizer   1.28247    19     1.681 0.1800  10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1se Lambda   389.76724     1     1.818 0.2137   4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Min Lambda     0.03898    30     3.573 1.2569  25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Daniel J. McDonald, Jiaping Liu, Zhenglun Cai.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

